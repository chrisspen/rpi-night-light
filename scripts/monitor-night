#!/usr/bin/env bash
set -euo pipefail
# Night: warm
# shellcheck disable=SC1091
source /etc/default/monitor-sun

DISPLAY_ID="${DISPLAY_ID:-1}"
NIGHT_R="${NIGHT_R:-50}"
NIGHT_G="${NIGHT_G:-10}"
NIGHT_B="${NIGHT_B:-0}"

ddcutil --display "$DISPLAY_ID" setvcp 14 0x0b >/dev/null 2>&1 || true   # ensure User 1
ddcutil --display "$DISPLAY_ID" setvcp 16 "$NIGHT_R" >/dev/null
ddcutil --display "$DISPLAY_ID" setvcp 18 "$NIGHT_G" >/dev/null
ddcutil --display "$DISPLAY_ID" setvcp 1A "$NIGHT_B" >/dev/null

if [[ -n "${NIGHT_BRIGHTNESS:-}" ]]; then
  ddcutil --display "$DISPLAY_ID" setvcp 10 "$NIGHT_BRIGHTNESS" >/dev/null
fi
